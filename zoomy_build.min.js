(function(e){var t=function(e,t,n){this.ele=e,this.options=t,this.event=n,this.image=e.find("img")};t.prototype.touch=touch="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?!0:!1,t.prototype.Helpers=function(e){var t=this,n={pos:{stop:function(e,t,n,r){return e-t-n+r},mouse:function(e,t,n){return e-t-n},zoom:function(e,t,n,r,i){return(e-t)/n-r+i}},css:function(e){return typeof e!="undefined"&&e.length>0?{backgroundPosition:"-"+e[0]+"px "+"-"+e[1]+"px",left:e[2],top:e[3]}:{}},ratio:function(e,t){return e/t},setParams:function(){t.size={},t.size.full=t.options.zoomSize+t.zoom.border*2,t.size.half=t.size.full/2,t.size.ratioX=t.Helpers("ratio")(t.css.width,t.zoom.x),t.size.ratioY=t.Helpers("ratio")(t.css.height,t.zoom.y),t.size.zoomX=t.zoom.x-t.size.full,t.size.zoomY=t.zoom.y-t.size.full,t.stop={},t.stop.main=t.size.half-t.size.half*t.size.ratioX-t.zoom.border*t.size.ratioX+t.zoom.border,t.stop.right=t.Helpers("pos").stop(t.css.width,t.size.full,t.zoom.border,t.stop.main),t.stop.bottom=t.Helpers("pos").stop(t.css.height,t.size.full,t.zoom.border,t.stop.main)}};return n[e]},e.fn.zoomy=function(n,r){var i={zoomSize:200,round:!0,glare:!0,clickable:!1,attr:"href",border:"5px solid #999",zoomInit:null,zoomStart:null,zoomStop:null},s=touch?"touchstart":"click";typeof n=="object"&&r===undefined?(r=n,n=s):n===undefined&&(n=s),r=e.extend({},i,r),e(this).each(function(){var i=e(this),s=new t(i,r,n);s.Build("init")()})},window.Zoomy=t})(jQuery),function(e){Zoomy.prototype.Change=function(e){var t=this,n={move:function(e){var n=t.ele.offset(),r=t.touch?-70:0,i=t.Helpers("pos").mouse(e.pageX,n.left,t.size.half),s=t.Helpers("pos").mouse(e.pageY+r,n.top,t.size.half),o=t.Helpers("pos").zoom(e.pageX,n.left,t.size.ratioX,t.size.half,t.zoom.border),u=t.Helpers("pos").zoom(e.pageY+r,n.top,t.size.ratioY,t.size.half,t.zoom.border),a={0:[o,u,i,s],1:[0,u,-t.stop.main,s],2:[0,0,-t.stop.main,-t.stop.main],3:[0,t.size.zoomY,-t.stop.main,t.stop.bottom],4:[o,0,i,-t.stop.main],5:[t.size.zoomX,0,t.stop.right,-t.stop.main],6:[t.size.zoomX,u,t.stop.right,s],7:[t.size.zoomX,t.size.zoomY,t.stop.right,t.stop.bottom],8:[o,t.size.zoomY,i,t.stop.bottom]},f=-t.stop.main<=i,l=-t.stop.main>i,c=-t.stop.main<=s,h=-t.stop.main>s,p=t.stop.bottom>s,d=t.stop.bottom<=s,v=t.stop.right>i,m=t.stop.right<=i,g=f&&c&&v&&p?0:l?c&&p?1:h?2:d?3:null:h?v?4:5:m?p?6:7:d?8:null,y=t.Helpers("css")(a[g]);t.zoomy.css(y||{})},classes:function(){t.state===0||t.state===null?t.ele.removeClass("inactive"):t.ele.addClass("inactive")},enter:function(){t.state=1,t.zoomy.css("visibility","visible"),t.Change("classes")},leave:function(e){var n=t.zoomy.attr("rel");e!==null?t.state=null:t.state=0,t.zoomy.css("visibility","hidden"),t.Change("classes")},callback:function(e){e!==null&&typeof callbacl=="function"&&e(t.pos)}};return n[e]}}(jQuery),function(e){Zoomy.prototype.Style=function(t){var n=this,r={round:function(e,t){return n.options.round?e===undefined?"100%":n.options.zoomSize/2+"px "+n.options.zoomSize/2+"px 0px 0px":0},glare:function(){n.zoomy.children("span").css({height:n.options.zoomSize/2,width:n.options.zoomSize-10,margin:e.browser.msie&&parseInt(e.browser.version,10)===9?0:"5px auto","border-radius":n.Style("round")(0)})},border:function(){var e=n.options.border.replace(/^\s*|\s*$/g,""),t=e.split(" "),r=parseFloat(t[0]),i=t.length>2&&r*1===r?r:0;return[e,i]},params:function(t,r){var i=n.ele.children("img"),s=n.Style("border")(),o={marginTop:i.css("margin-top"),marginRight:i.css("margin-right"),marginBottom:i.css("margin-bottom"),marginLeft:i.css("margin-left")},u={"float":i.css("float")},a={display:"block",height:i.height(),width:i.width(),position:"relative"},f=function(){var e=n.ele.parent("*:first").css("text-align");e==="center"&&(o.marginRight="auto",o.marginLeft="auto")},l=n.zoomy.attr("rel"),c={};u.float==="none"&&f(),e.extend(c,o,u,a),n.css=c,n.options.glare||n.zoomy.children("span").css({height:n.options.zoomSize-10,width:n.options.zoomSize-10}),n.zoomy.css({height:n.options.zoomSize,width:n.options.zoomSize,"border-radius":n.Style("round")(undefined,s[1]),border:s[0]}),n.image.css("margin","0px"),n.image.one("load",function(){n.ele.css(n.css),n.ele.parent(".zoomy-wrap").length&&n.ele.parent(".zoomy-wrap").css(n.css)}).each(function(){(this.complete||e.browser.msie&&parseInt(e.browser.version,10)===6)&&e(this).trigger("load")})}};return r[t]}}(jQuery),function(e){Zoomy.prototype.Events=function(){var t=this,n=[],r={move:t.touch?"touchmove":"mousemove",begin:t.touch?"touchstart":"mouseover",end:t.touch?"touchend":"mouseleave",quick:t.touch?"tap":"click"},i=function(e,n){e=t.touch?n?n.touches[0]||n.changedTouches[0]:e.originalEvent.touches[0]||e.originalEvent.changedTouches[0]:e,t.Change("move")(e)},s=function(){t.Change("enter")(),t.ele.bind(r.move,i),t.Change("callback")(t.options.zoomStart,t.zoom)},o=function(e){t.Change("leave")(e),t.ele.unbind(r.move,i),t.Change("callback")(t.options.zoomStop,t.zoom)},u=function(e,n){e=t.touch?n?n.touches[0]||n.changedTouches[0]:e.originalEvent.touches[0]||e.originalEvent.changedTouches[0]:e,t.pos=e,t.state===0&&s()},a=function(e){t.pos=e,t.state===1&&o(null)},f={event:function(e){t.pos=e,t.options.clickable||e.preventDefault(),t.state===0||t.state===null?(s(),e=t.touch&&typeof e.originalEvent=="object"?e.originalEvent.changedTouches[0]||e.originalEvent.touches[0]:e,t.Change("move")(e)):t.state===1&&t.event!=="mouseover"&&t.event!=="mouseenter"&&o(0)},mouseover:u,mouseleave:a,touchstart:u,touchend:a,click:function(e){e.preventDefault(),e.stopPropagation()}};t.event==="mouseover"||t.event==="touchstart"?n[t.event]=f.event:(n[t.event]=f.event,n[r.begin]=f[r.begin]),!t.options.clickable&&t.event!=="click"&&(n.click=f.click),n[r.end]=f[r.end];if(t.touch){var l=t.ele.siblings(".zoomy-btn"),c=l.parent("div"),h=setTimeout(),p=function(e){t.ele.bind(n),t.ele.trigger("touchstart",e.originalEvent),t.ele.trigger("touchmove",e.originalEvent),c.addClass("active")},d=function(){c.removeClass("active"),t.ele.trigger("touchend"),t.ele.unbind(n)},v=function(){};l.bind({touchstart:p,touchmove:function(e){e.preventDefault(),t.ele.trigger("touchmove",e.originalEvent)},touchend:d}),document.oncontextmenu=function(){return!1},e(document).mousedown(function(e){return e.button==2?!1:!0})}else t.ele.bind(n);e(window).resize(function(){t.ele.attr("style","").parent(".zoomy-wrap").attr("style",""),window.setTimeout(function(){t.Style("params")()},100)})}}(jQuery),function(e){Zoomy.prototype.Build=function(t){var n=this,r={image:function(t){n.zoomy.show().css({top:"-999999px",left:"-999999px"}),n.zoomy.find("img").attr("src")!==t&&n.zoomy.find("img").attr("src",t).load(function(){var e=n.options.glare?"<span/>":"",r=n.Style("border")();n.zoom={x:n.zoomy.find("img").width(),y:n.zoomy.find("img").height(),border:r[1]},n.zoomy.append(e).css({"background-image":"url("+t+")"}).find("img").remove(),n.Style("glare")(),n.Helpers("setParams")()}).each(function(){(this.complete||e.browser.msie&&parseInt(e.browser.version,10)===6)&&e(this).trigger("load")})},zoom:function(){n.state=null;var e=n.ele.attr("href");initCallback=n.options.zoomInit,touchCallToAction="touch",magColor="#efefef",icon='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="40px" height="40px" viewBox="0 0 50 50" overflow="inherit" xml:space="preserve"><defs><filter id="drop-shadow"><feGaussianBlur in="SourceAlpha" result="blur-out" stdDeviation="1" /><feOffset in="blur-out" result="the-shadow" dx="0" dy="1"/><feBlend in="SourceGraphic" in2="the-shadow" mode="normal"/></filter></defs><path filter="url(#drop-shadow)" fill="'+magColor+'" d="M23.265,30.324l-9.887,9.887l-3.64-3.641l9.942-9.941c-2.687-4.42-2.134-10.246,1.668-14.049 c4.469-4.469,11.732-4.451,16.224,0.04c4.491,4.491,4.509,11.754,0.04,16.224C33.723,32.732,27.718,33.223,23.265,30.324z M24.601,15.833c-2.681,2.681-2.67,7.039,0.024,9.733s7.053,2.705,9.733,0.025c2.682-2.681,2.671-7.04-0.023-9.734 C31.641,13.162,27.282,13.152,24.601,15.833z"/></svg>'+touchCallToAction,button=n.touch?['<div class="zoomy-wrap" />','<div class="zoomy-btn">'+icon+"</div>"]:["",""],n.ele.addClass("parent-zoom").wrap(button[0]).append('<div class="zoomy"><img id="tmp"/></div>').after(button[1]),n.zoomy=n.ele.find(".zoomy"),setTimeout(n.Events(),100),initCallback!==null&&typeof initCallback=="function"&&initCallback(),n.Style("params")(),n.Build("image")(e)},init:function(){var t=e("<img />").attr("src",n.image.attr("src"));t.one("load",function(){n.Build("zoom")()}).each(function(){(this.complete||e.browser.msie&&parseInt(e.browser.version,10)===6)&&e(this).trigger("load")})}};return r[t]}}(jQuery);